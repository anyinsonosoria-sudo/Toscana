# üöÄ GU√çA PASO A PASO: Instalar y Usar Sistema OCR

## PARTE 1: INSTALACI√ìN (UNA SOLA VEZ)

### Paso 1: Instalar Tesseract-OCR en tu Sistema Operativo

#### üíª Si usas WINDOWS:

1. Abre navegador y ve a:
   ```
   https://github.com/UB-Mannheim/tesseract/wiki
   ```

2. En la secci√≥n "Downloads", busca el enlace de descarga:
   ```
   Tesseract-OCR-w64-v5.x.exe
   ```
   (busca la versi√≥n m√°s reciente disponible)

3. Descarga el archivo ejecutable

4. Haz doble clic en el instalador descargado

5. En el asistente de instalaci√≥n:
   - Acepta t√©rminos y condiciones
   - Deja la ruta de instalaci√≥n por defecto: `C:\Program Files\Tesseract-OCR`
   - Contin√∫a siguiente hasta completar
   - Haz clic en "Finish" cuando termine

6. **IMPORTANTE**: Reinicia la aplicaci√≥n Flask despu√©s

#### üçé Si usas macOS:

Abre Terminal y ejecuta:
```bash
brew install tesseract
```

Reinicia la aplicaci√≥n Flask.

#### üêß Si usas Linux (Ubuntu/Debian):

Abre Terminal y ejecuta:
```bash
sudo apt-get update
sudo apt-get install tesseract-ocr
```

Reinicia la aplicaci√≥n Flask.

### Paso 2: Verificar que Todo Funciona

Desde la carpeta del proyecto (`building_maintenance`), ejecuta:

```bash
python test_ocr.py
```

Deber√≠as ver algo como:
```
======================================================================
TEST DE CONFIGURACI√ìN OCR
======================================================================

Verificando imports...
‚úì ocr_processing importado correctamente
‚úì Pillow importado correctamente
‚úì pytesseract importado correctamente

Verificando Tesseract-OCR...
‚úì Tesseract v5.x.x disponible

Probando funciones OCR...
‚úì Extracci√≥n de monto funciona
‚úì Extracci√≥n de fecha funciona
‚úì C√°lculo de confianza funciona

Verificando estructura de carpetas...
‚úì Carpeta static\uploads existe
‚úì ocr_processing.py existe
‚úì ocr_setup.py existe
‚úì expenses.py existe
‚úì app.py existe
‚úì templates/gastos.html existe

======================================================================
RESUMEN DE TESTS
======================================================================
Imports........................................... ‚úì PASADO
Tesseract-OCR..................................... ‚úì PASADO
Procesamiento OCR................................. ‚úì PASADO
Estructura de carpetas............................ ‚úì PASADO

‚úì Sistema OCR listo para usar!
```

Si ves los ‚úì para todos, ¬°est√°s listo!

---

## PARTE 2: USO DIARIO (CADA VEZ QUE NECESITES REGISTRAR UN GASTO)

### Paso 1: Preparar la Foto del Recibo

1. Toma una **foto clara** del recibo
   - Aseg√∫rate que est√© bien iluminada
   - Todo el recibo debe ser visible
   - Intenta un √°ngulo recto (no de lado)

2. Guarda la foto en tu tel√©fono o c√°mara

### Paso 2: Abr√≠r la Aplicaci√≥n Web

1. Abre tu navegador (Chrome, Firefox, Edge, Safari)

2. Ve a:
   ```
   http://localhost:5000/gastos
   ```
   
   (Si tienes la app en otro servidor, usa esa direcci√≥n)

3. Deber√≠as ver la p√°gina de "Gesti√≥n de Gastos"

### Paso 3: Cargar la Foto del Recibo

1. Busca el bot√≥n verde grande que dice:
   ```
   üü¢ Cargar Recibo (OCR)
   ```

2. Haz clic en ese bot√≥n

3. Se abrir√° una ventana modal con el t√≠tulo:
   ```
   Cargar Recibo - Extracci√≥n OCR
   ```

### Paso 4: Seleccionar la Imagen

En la secci√≥n "Paso 1: Cargar Imagen":

1. Haz clic en:
   ```
   [Selecciona una imagen de recibo]
   ```

2. Se abrir√° el explorador de archivos

3. Busca y selecciona la foto del recibo que tomaste

4. Haz clic en "Abrir"

5. Ver√°s una **vista previa** de la foto dentro de la modal

### Paso 5: Procesar con OCR

1. Haz clic en el bot√≥n:
   ```
   ‚ö° Procesar con OCR
   ```

2. Ver√°s un mensaje:
   ```
   ‚è≥ Extrayendo informaci√≥n del recibo...
   ```

3. Espera 1-2 segundos mientras procesa

4. El sistema autom√°ticamente extrae:
   - üìù **Descripci√≥n**: Qu√© es el gasto
   - üí∞ **Monto**: Cu√°nto cuesta
   - üìÖ **Fecha**: Cu√°ndo fue
   - üè™ **Suplidor**: Qui√©n vendi√≥

### Paso 6: Revisar los Datos Extra√≠dos

Ahora ves la secci√≥n "Paso 2: Revisar y Ajustar Informaci√≥n Extra√≠da"

**Ver√°s:**
- ‚≠ê Un indicador de confianza (ej: "Confianza: 85%")
- Varios campos editables ya rellenos
- El texto completo extra√≠do abajo en "Texto Extra√≠do (RAW)"

**Los campos son:**
```
Descripci√≥n:  [FERRETERIA ABC - Compra de materiales]  ‚Üê puedes cambiar
Monto:        [2500.00]                                 ‚Üê puedes cambiar
Categor√≠a:    [_____________]                           ‚Üê completa si quieres
Suplidor:     [FERRETERIA ABC]                          ‚Üê puedes cambiar
Fecha:        [2024-01-09]                              ‚Üê puedes cambiar
M√©todo Pago:  [Seleccionar]                             ‚Üê completa si quieres
Notas:        [_____________]                           ‚Üê agrega notas si quieres
```

### Paso 7: Ajustar Datos (Si es Necesario)

Si el OCR extrajo informaci√≥n incorrecta:

1. Haz clic en el campo que quieras cambiar
2. Borra el contenido actual
3. Escribe la informaci√≥n correcta
4. Contin√∫a al siguiente paso

**Nota importante:** Si la confianza es **< 60%** (baja), revisa cuidadosamente todos los datos, especialmente el **monto**.

### Paso 8: Guardar el Gasto

1. Cuando est√©s seguro de que todos los datos son correctos

2. Haz clic en el bot√≥n azul:
   ```
   ‚úÖ Guardar Gasto
   ```

3. El sistema:
   - Guarda el gasto en la base de datos
   - Guarda la foto en la carpeta `static/uploads/`
   - Te redirige a la lista de gastos

4. Ver√°s un mensaje verde que dice:
   ```
   ‚úÖ Gasto registrado con √©xito
   ```

### Paso 9: ¬°Listo! Gasto Registrado

Tu nuevo gasto ahora aparece en la tabla de gastos:
- Ves todos sus datos
- Puedes editar o eliminar si lo necesitas
- Tienes la foto como evidencia

---

## DIFICULTADES Y SOLUCIONES

### ‚ùå Problema: "No se pudo extraer texto de la imagen"

**Posibles causas:**
- La foto est√° borrosa
- El recibo est√° de lado o parcial
- Muy oscuro o de mala iluminaci√≥n
- El archivo no es una imagen v√°lida

**Soluci√≥n:**
1. Intenta de nuevo con una foto m√°s clara
2. Aseg√∫rate de que el recibo est√© completamente visible
3. Toma la foto en mejor iluminaci√≥n
4. Si sigue fallando, completa los datos manualmente sin OCR

### ‚ùå Problema: "Tesseract OCR no disponible"

**Causa:** No instalaste Tesseract-OCR en tu sistema operativo

**Soluci√≥n:**
1. Sigue la "PARTE 1: INSTALACI√ìN" de arriba
2. Descarga e instala Tesseract seg√∫n tu sistema operativo
3. Reinicia la aplicaci√≥n Flask
4. Intenta de nuevo

### ‚ùå Problema: Confianza muy baja (< 60%)

**Causa:** El OCR tuvo dificultad para extraer informaci√≥n

**Soluci√≥n:**
1. Revisa muy cuidadosamente todos los campos, especialmente el **monto**
2. Ajusta manualmente los valores que veas incorrectos
3. Si el monto parece estar mal, c√°mbialo antes de guardar

### ‚ö†Ô∏è Problema: El monto extra√≠do es incorrecto

**Ejemplo:** 
- Recibo dice: "2.500,00"
- Sistema extrajo: "2.50"

**Soluci√≥n:**
1. Haz clic en el campo "Monto"
2. Borra lo que est√°
3. Escribe el monto correcto: `2500.00`
4. Guarda

### üìã Problema: Necesito volver a la pantalla anterior

**Soluci√≥n:**
Haz clic en el bot√≥n:
```
‚¨ÖÔ∏è Volver
```

Esto te regresa al "Paso 1" para cargar otra imagen.

### ‚ùì Problema: No s√© qu√© es la "Confianza"

**Explicaci√≥n:**
- **Confianza**: Es un porcentaje que indica qu√© tan seguro est√° el sistema de la informaci√≥n extra√≠da
- **80%+**: ‚úì Muy confiable, los datos est√°n probablemente correctos
- **60-79%**: ~ Decente, revisa los datos cuidadosamente
- **< 60%**: ‚ö†Ô∏è Baja, verifica todo, especialmente el monto

---

## EJEMPLO COMPLETO PASO A PASO

### Escenario: Tienes un recibo de una compra en ferreter√≠a

```
PASO 1: Tienes foto del recibo
        ‚Üì
PASO 2: Abres http://localhost:5000/gastos
        ‚Üì
PASO 3: Haces clic en "Cargar Recibo (OCR)"
        ‚Üì
PASO 4: Seleccionas la foto
        ‚Üì
PASO 5: Haces clic en "Procesar con OCR"
        ‚Üì
PASO 6: Sistema muestra:
        - Descripci√≥n: "FERRETERIA ABC - Venta de materiales"
        - Monto: 2500.00
        - Fecha: 2024-01-09
        - Suplidor: "FERRETERIA ABC"
        - Confianza: 85% ‚≠ê
        ‚Üì
PASO 7: Revisas los datos, todos est√°n bien ‚úì
        ‚Üì
PASO 8: Haces clic en "Guardar Gasto"
        ‚Üì
PASO 9: ¬°Listo! Gasto registrado
        Ves en la lista:
        - ID: 42
        - Fecha: 2024-01-09
        - Descripci√≥n: FERRETERIA ABC - Venta de materiales
        - Monto: 2.500,00
        - Foto: [est√° guardada]
```

---

## CARACTER√çSTICAS √öTILES

### üì∏ Vista Previa de Imagen
- Antes de procesar, ves una vista previa
- Puedes verificar que la foto est√© correcta

### ‚úèÔ∏è Campos Editables
- Puedes cambiar cualquier dato antes de guardar
- √ötil si el OCR se equivoc√≥ en algo

### üìù Categor√≠a y Notas
- Puedes agregar categor√≠a (opcional)
- Puedes agregar notas adicionales (opcional)

### üè™ Seleccionar Suplidor
- De una lista de suplidores existentes
- O dejar en blanco

### üí≥ M√©todo de Pago
- Efectivo
- Transferencia
- Cheque
- Tarjeta

---

## CONSEJOS PARA MEJOR OCR

‚úÖ **HACER:**
- Tomar fotos en **buena iluminaci√≥n**
- Foto **enfocada** y **clara**
- Recibo **completamente visible**
- √Ångulo **perpendicular** (no de lado)
- Fondos **neutros** (blanco, gris)

‚ùå **NO HACER:**
- Fotos **borrosas** o fuera de foco
- Recibos **parcialmente** visibles
- **Sombras** o mala iluminaci√≥n
- Fotos de **lado** o en √°ngulo
- Fondos con **patrones** complicados

---

## ATAJOS TECLADO

| Tecla | Acci√≥n |
|-------|--------|
| `Esc` | Cierra la modal OCR |
| `Tab` | Se mueve entre campos |
| `Enter` | En ciertos campos, puede enviar |

---

## PREGUNTAS FRECUENTES

### P: ¬øFunciona con cualquier tipo de recibo?
R: S√≠, con la mayor√≠a. Funciona mejor con recibos en espa√±ol. Si el dise√±o es muy especial puede ser menos preciso.

### P: ¬øPuedo procesar m√∫ltiples recibos a la vez?
R: No, uno a la vez. Pero es muy r√°pido, as√≠ que no toma mucho tiempo.

### P: ¬øSe borran las fotos al eliminar un gasto?
R: No est√° autom√°tico. Si necesitas borrar archivos, hazlo manualmente en `static/uploads/`.

### P: ¬øQu√© pasa si carbo la foto sin procesar OCR?
R: Si vuelves sin procesar, no pasa nada. Simplemente no se guarda.

### P: ¬øPuedo ver la foto despu√©s de guardar?
R: Actualmente se guarda pero no hay visualizador. Puedes verla en `static/uploads/`.

---

## SOPORTE

Si tienes problemas:

1. **Verifica la instalaci√≥n:**
   ```bash
   python test_ocr.py
   ```

2. **Revisa los logs** de la aplicaci√≥n Flask (console)

3. **Intenta de nuevo** con una foto diferente

4. **Consulta** la documentaci√≥n completa en `OCR_README.md`

---

## RESUMEN R√ÅPIDO

```
Instalar una vez:
  1. Descargar Tesseract-OCR
  2. Ejecutar instalador
  3. Reiniciar app

Usar cada vez:
  1. Tomar foto del recibo
  2. Abrir /gastos
  3. Clic "Cargar Recibo"
  4. Seleccionar foto
  5. Clic "Procesar"
  6. Revisar datos
  7. Clic "Guardar"
  ‚úÖ ¬°Listo!
```

---

**¬°Disfruta del sistema OCR! üéâ**

Creado: 9 de enero de 2024
Versi√≥n: 1.0
