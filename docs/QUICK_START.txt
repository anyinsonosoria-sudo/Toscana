# üéØ GU√çA R√ÅPIDA: Sistema OCR para Recibos

## Resumen

Se ha implementado un sistema completo de OCR (Optical Character Recognition) para cargar fotos de recibos de gastos y extraer autom√°ticamente:
- Descripci√≥n del gasto
- Monto
- Fecha
- Nombre del suplidor

## Paso 1: Instalar Tesseract-OCR (REQUERIDO)

Este es el √öNICO paso manual necesario. Las librer√≠as Python ya est√°n instaladas.

### Windows:
1. Descarga desde: https://github.com/UB-Mannheim/tesseract/wiki
2. Busca el archivo: `tesseract-ocr-w64-v5.x.exe`
3. Ejecuta el instalador
4. Aceptar instalaci√≥n por defecto en `C:\Program Files\Tesseract-OCR`
5. **Reinicia la aplicaci√≥n Flask**

### macOS:
```bash
brew install tesseract
```

### Linux (Ubuntu/Debian):
```bash
sudo apt-get update && sudo apt-get install tesseract-ocr
```

## Paso 2: Verificar Instalaci√≥n

Ejecuta:
```bash
python test_ocr.py
```

Deber√≠as ver "‚úì PASADO" para todos los tests (excepto que Tesseract puede estar faltante).

## Paso 3: Usar en la Aplicaci√≥n

1. Inicia Flask: `python app.py`
2. Ve a: `http://localhost:5000/gastos`
3. Haz clic en bot√≥n verde: **"Cargar Recibo (OCR)"**
4. Sube una foto de un recibo
5. El sistema extrae la informaci√≥n autom√°ticamente
6. Ajusta si es necesario
7. Guarda el gasto

## ‚ú® Nuevos Archivos Creados

```
ocr_processing.py      - M√≥dulo OCR principal (procesamiento de im√°genes)
ocr_setup.py          - Script de setup e instalaci√≥n
test_ocr.py           - Tests para verificar configuraci√≥n
OCR_README.md         - Documentaci√≥n completa
QUICK_START.txt       - Este archivo
```

## üìù Archivos Modificados

```
expenses.py           - Nuevo: save_receipt_image(), get_receipt_path()
app.py                - Nuevas rutas: /gastos/upload-recibo, /gastos/save-with-receipt
templates/gastos.html - Nueva modal OCR con flujo de 2 pasos
db.py                 - Nueva columna: receipt_path en tabla expenses
requirements.txt      - A√±adidas: Pillow, pytesseract
```

## üîß Caracter√≠sticas T√©cnicas

- **Reconocimiento OCR en espa√±ol**: Extrae texto en idioma espa√±ol
- **Niveles de confianza**: Muestra qu√© tan precisa fue la extracci√≥n (55%-95%)
- **Almacenamiento de fotos**: Guarda las im√°genes en `static/uploads/`
- **Interfaz intuitiva**: Modal de 2 pasos (carga ‚Üí revisi√≥n ‚Üí guardado)
- **Validaci√≥n de archivos**: Solo acepta PNG, JPG, GIF, WEBP
- **Optimizaci√≥n de im√°genes**: Mejora autom√°ticamente la calidad para OCR

## üìä Campos Extra√≠dos

| Campo | Extracci√≥n |
|-------|-----------|
| **Descripci√≥n** | Primeras l√≠neas del recibo |
| **Monto** | Busca patrones como "Total:", "Monto:" |
| **Fecha** | Detecta formatos DD/MM/YYYY, YYYY-MM-DD |
| **Suplidor** | Primera l√≠nea con texto significativo |
| **Confianza** | Porcentaje basado en cantidad de texto extra√≠do |

## üí° Ejemplos de Uso

### Ejemplo 1: Recibo de Ferreter√≠a
```
FOTO: Foto del recibo de una compra en ferreter√≠a
‚Üì
OCR extrae:
- Descripci√≥n: "FERRETERIA ABC - Compra de materiales"
- Monto: 2.500,00
- Fecha: 2024-01-09
- Suplidor: "FERRETERIA ABC"
‚Üì
Usuario verifica y guarda
```

### Ejemplo 2: Recibo de Servicios
```
FOTO: Foto de pago de servicios (agua, luz)
‚Üì
OCR extrae autom√°ticamente los datos
‚Üì
Usuario ajusta si es necesario
‚Üì
Se guarda con la imagen como evidencia
```

## ‚ö†Ô∏è Notas Importantes

1. **Calidad de la foto**: Mejor foto = mejor OCR
   - ‚úì Bien iluminada
   - ‚úì Enfocada y clara
   - ‚úì Recibo completamente visible

2. **Idioma**: Configurado para espa√±ol
   - Para otros idiomas, editar ocr_processing.py l√≠nea ~60

3. **Confianza baja**: Si es <60%, ajusta manualmente antes de guardar

## üÜò Troubleshooting

### "Tesseract OCR no est√° instalado"
‚Üí Instala desde: https://github.com/UB-Mannheim/tesseract/wiki

### "No se pudo extraer texto"
‚Üí Intenta con una foto m√°s clara del recibo

### "pytesseract not found"
‚Üí Ejecuta: `pip install pytesseract Pillow`

## üìû Pr√≥ximos Pasos

Opciones futuras pueden incluir:
- [ ] Soporte para m√∫ltiples idiomas
- [ ] Extracci√≥n de detalles de l√≠nea (art√≠culos individuales)
- [ ] Integraci√≥n con APIs en la nube (Google Vision, AWS)
- [ ] Exportaci√≥n de datos extra√≠dos

---

**Estado**: ‚úÖ Sistema completamente implementado y listo para usar

**√öltima actualizaci√≥n**: 2024-01-09
